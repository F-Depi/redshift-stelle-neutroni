% Run this command from vim
% :!pdflatex -interaction=batchmode main.tex && evince main.pdf &
% then to run the last command that starts with :! just do :!!

\documentclass[a4paper, titlepage]{article}

\input{packages}
%\input{frontespizio}


\begin{document}

\tableofcontents

\section{Introduzione}
Studiamo la stabilità delle stelle di neutroni in regime relativistico considerando 3 possibili equazioni di stato per la materia.
Una volta risolte le equazioni è possibile ottenere l'espressione del potenziale gravitazione della stella e calcolare l'effetto sulla radiazione emessa dalla stella.


Viene calcolata la radianza per ogni stella a 3 distanze diverse e la potenza totale di emissione in funzione della distanza dalla stella.
Viene quindi calcolata la temperatura apparente delle 3 stelle più massive in funzione di quella effettiva e poi viene studiata la temperatura apparente in funzione della pressione centrale della stella.

\section{Stabilità}

Le equazioni che descrivono la stabilità di una stella in funzione della massa ($m$) e della pressione ($P$) sono quelle di Tolman-Oppenheimer-Volkoff
\begin{equation}
    \begin{dcases}
        \dv[]{P(r)}{r} = - G \frac{m(r) \epsilon (r)}{r^2 c^2} \left(1 + \frac{P(r)}{\epsilon (r)} \right) \left(\ + \frac{4 \pi r^3 P(r)}{m(r) c^2} \right) \left(1 - \frac{2 G m(r)}{r c^2} \right)^{-1} \\
        \dv[]{m(r)}{r} = 4 \pi r^2 \frac{\epsilon (r)}{c^2} \\
        \dv[]{\Phi(r)}{r} = - \frac{1}{P(r) + \epsilon (r)} \dv[]{P(r)}{r}
    \end{dcases}
    \label{eq:sistema_corr}
\end{equation}

Dove la terza equazione è l'equazione disaccoppiata e descrive il potenziale gravitazionale della stella.
Usiamo 3 diverse densità di energia per la materia della stella (eq. \ref{eq:energia1} viene presa con due coppie di valori diversi di $\Gamma$ e $K$):
\begin{align}
    \epsilon_1 (n) &= a \left( \frac{n}{n_0} \right) ^{\alpha} + b \left( \frac{n}{n_0} \right) ^{\beta} \\
    \label{eq:energia1}
    \epsilon_{2/3} (n) &= \mu c^2n+Kc^2n^\Gamma
    \label{eq:energia23}
\end{align}
\begin{equation}
    \text{con} \quad a = 13.4 \unit{\mega\electronvolt\per\femto\cubic\meter}, \quad
    \alpha = 0.514, \quad
    b = 5.62 \unit{\mega\electronvolt\per\femto\cubic\meter}, \quad
    \beta = 2.436, \quad
    n_0 = 0.16 \unit{\per\femto\cubic\meter} \\
\end{equation}

dove $n$ è la densità numerica, $\mu$ la massa di una singola particella e quindi $\rho = \mu n$ è la densità di massa.


Visto che la densità di energia è in funzione di $\rho$ e le incognite del sistema \ref{eq:sistema_corr} sono $P$ e $m$ possiamo scrivere la densità di energia in funzione di $P$ e $m$ partendo dalla relazione termodinamica

\begin{equation}
    P = - \dv[]{E}{V} \quad \Rightarrow \quad
    \begin{cases}
        P = (\alpha - 1) a \left( \frac{n}{n_0} \right)^{\alpha} (\beta - 1) b \left( \frac{n}{n_0} \right)^{\beta} & \text{per } \epsilon_1 \\
        n = \left( \frac{P}{K(\Gamma - 1) c^2} \right) ^ {1 / \Gamma} & \text{per } \epsilon_{1/2}
    \end{cases}
    \label{eq:eps(r)}
\end{equation}

Nel primo caso non è stato possibile invertire l'equazione per trovare $n$ in funzione di $P$ e $m$ quindi utilizzeremo un metodo numerico per trovare $n$ di volta in volta.


Facciamo le seguenti sostituzioni per rendere le variabili adimensionali e con valori più vicini a 0.

\begin{equation*}
    m=M_0\hat m, \quad 
    r=R_0\hat r, \quad 
    P=P_0\hat P, \quad
    \rho=\rho_0 \hat{\rho}, \quad
    K = \hat{K}\frac{\mu^\Gamma}{\rho_0^{\Gamma-1}},
\end{equation*}

\begin{equation}
    \begin{dcases}
        \dv[]{\hat P}{\hat r} = - \frac{(\hat P + \hat{\epsilon})(\hat m + \hat r^3 \hat P)}{\hat r^2-2\hat m\hat r}\\
        \dv[]{\hat m}{\hat r} = \hat r^2 \hat{\epsilon} \\
        \dv[]{\Phi}{\hat r} = - \frac{1}{\hat P + \hat{\epsilon}} \dv[]{\hat P}{\hat r}
    \end{dcases}
    \label{eq:sistema_adim}
\end{equation}

Otteniamo il sistema \ref{eq:sistema_adim} dove, grazie alle equazioni in \ref{eq:eps(r)}, $\hat m$, $\hat P$ e $\hat{\epsilon}$ sono funzioni di $\hat r$. Come valori delle costanti sono stati usati

\begin{equation}
    M_0 = 12.655756 M_\odot \quad R_0 = 20.06145 \unit{\kilo\meter} \quad \epsilon = P_0 = \rho_0 c^2 = 150.174 \frac{\unit{\mega\electronvolt}}{c^2 \unit{\femto\meter}}
\end{equation}

Per il potenziale gravitazionale $\Phi$ si può inoltre trovare una soluzione analitica all'esterno della stella che possiamo mettere in forma adimensionale (eq. \ref{eq:Phi_ext}), dove $\hat{M}$ e $\hat R$ sono rispettivamente la massa totale e il raggio della stella in forma adimensionale.

\begin{equation}
    \Phi_\text{ext} (r) = \frac{1}{2} \log(1 - \frac{2 G M}{r c^2})
    \implies \Phi_\text{ext} (\hat r) = \frac{1}{2} \log(1 - \frac{2 \hat{M}}{\hat r}) \quad \quad \hat r \geq \hat{R}
    \label{eq:Phi_ext}
\end{equation}


\section{Curva massa raggio}
Vengono risolte le prime due equazioni del sistema \ref{eq:sistema_adim} con il metodo \texttt{RK4} (appendice \ref{ap:RK4}).
Per il caso con equzione di stato più complessa (eq. \ref{eq:energia1}) viene risolta numericamente l'equazione \ref{eq:eps(r)1} (Appendice \ref{ap:eps(r)1}).













\newpage
\appendix

\section{RK4} \label{ap:RK4}
Codice con cui è stato implementato il metodo \texttt{RK4}. \texttt{fun\_P()} e \texttt{fun\_m()} sono le funzioni presenti a destra dell'uguale nella prima e nella seconda riga del sistema \ref{eq:sistema_adim}.

\begin{lstlisting}
void rungeKutta4(double h, double r, double *P, double *m, int tipo_politropica){

    double k1, k2, k3, k4, l1, l2, l3, l4;

    k1 = h * fun_m(r, *P, tipo_politropica);
    l1 = h * fun_P(r, *P, *m, tipo_politropica);

    k2 = h * fun_m(r + h / 2, *P + l1 / 2, tipo_politropica);
    l2 = h * fun_P(r + h / 2, *P + l1 / 2, *m + k1 / 2, tipo_politropica);

    k3 = h * fun_m(r + h / 2, *P + l2 / 2, tipo_politropica);
    l3 = h * fun_P(r + h / 2, *P + l2 / 2, *m + k2 / 2, tipo_politropica);

    k4 = h * fun_m(r + h, *P + l3, tipo_politropica);
    l4 = h * fun_P(r + h, *P + l3, *m + k3, tipo_politropica);

    *m += (k1 + 2 * k2 + 2 * k3 + k4) / 6;
    *P += (l1 + 2 * l2 + 2 * l3 + l4) / 6;
}
\end{lstlisting}

\end{document}


